{{define "changepw"}}{{ template "header" . }} 
      <div class="row">
        <div class="col">
		<div id="container" class="card" style="width: 25em">
		  <div class="card-body">
		    <h2 class="card-title">Change Password</h2>
		    <br>
		    <p class="card-text"> A password change has been requested.<br>Please enter a new password.<br><br>
			<form method="post" action="./changePassword" id="form" name="form" onSubmit="return submitForm()">
			    <div class="mb-3">
				<input type="password" class="form-control mx-auto" style="max-width: 300px;" 
				       required minlength="{{.MinPasswordLength}}" placeholder="New Password" 
				       id="newpw" name="newpw" autocomplete="new-password">
			    </div>

			    <div class="mb-3">
				<input type="password" class="form-control mx-auto" style="max-width: 300px;" 
				       required minlength="{{.MinPasswordLength}}" placeholder="Confirm New Password" 
				       id="newpw_c" name="newpw_c" onchange="checkSame()" autocomplete="new-password">
			    </div>

{{ if ne .ErrorMessage "" }}
			    <p id="errormessage" class="text-danger" style="margin-top:1em">{{.ErrorMessage}}</p>
{{ end }}

			    <div id="pwnotsame" class="text-warning" style="display: none; margin-top:1em">
				Passwords do not match
			    </div>

			    <div class="mt-4">
				<button type="submit" id="submitbutton" class="btn btn-primary w-100 mx-auto" style="max-width: 300px;">
				    Change Password
				</button>
			    </div>
			</form>
			<br>
		  </div>
		</div>
	    </div>
   	 </div>
<script>

function isSamePw() {
    let pw1 = document.getElementById("newpw").value;
    let pw2 = document.getElementById("newpw_c").value;
    return pw1 === pw2;
}

function checkSame() {
    if (!isSamePw()) {
        document.getElementById("pwnotsame").style.display = "block";
    } else {
        document.getElementById("pwnotsame").style.display = "none";
    }
    let serverErr = document.getElementById("errormessage");
    if (serverErr!= null) {
    	serverErr.style.display = "none";
    }
}

function submitForm() {
    if (!isSamePw()) {
        return false;
    }
    document.getElementById("submitbutton").disabled = true;
    return true;
}

</script>
{{ template "pagename" "ChangePw"}}
{{ template "customjs" .}}
{{ template "footer" }}
{{end}}
