{{ define "uploadreq" }}{{ template "header" . }}
<div class="row">
    <div class="col">
        <div id="container" class="card" style="width: 80%">
            <div class="card-body">
		<div class="container">
		  <div class="row mb-4">
		    <div class="col">
		    </div>
		    <div class="col text-center">
		      <h3 class="card-title mb-0">File Requests</h3>
		    </div>
		    <div class="col text-end">
		      <button id="button-newapi" class="btn btn-outline-light" onclick="newFileRequest()">
                    <i class="bi bi-plus-circle-fill"></i>
                </button>
		    </div>
		  </div>
		</div>
		
                <br>
                <div class="table-responsive">
                    <table class="table table-dark">
                        <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">Uploaded Files</th>
                                <th scope="col">Last Upload</th>
                                <th scope="col">Expiry</th>
{{ if .ActiveUser.HasPermissionListOtherUploads }}
            			<th scope="col">User</th>
{{ end }}
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="filerequesttable">
                        
{{ range .FileRequests }}
                            <tr id="row-{{ .Id }}">
		                    <td>{{ .Name }}</td>
		                    <td>{{ .UploadedFiles }}</td>
		                    <td>{{ .GetReadableDateLastUpdate }}</td>
		                    <td>{{ .GetReadableDateExpiry }}</td>
{{ if $.ActiveUser.HasPermissionListOtherUploads }}
		                    <td>{{(index $.UserMap .Owner).Name}}</td>
{{ end }}
		                    <td>
		                    	<div class="btn-group" role="group">
                                <button id="download-{{ .Id }}" type="button" class="btn btn-outline-light btn-sm {{ if eq .UploadedFiles 0 }} disabled {{ end }}"  onclick="" title="Download all"><i class="bi bi-download"></i></button>
                                
		                        <button id="edit-{{ .Id }}" type="button" onclick="" title="Edit request" class="btn btn-outline-light btn-sm">
		                        	<i class="bi bi-pencil"></i></button>
                                
                                
                                <button id="delete-{{ .Id }}" type="button" class="btn btn-outline-danger btn-sm" onclick="deleteOrShowModal({{ .Id }}, '{{ .Name }}', {{ .UploadedFiles }})" title="Delete"><i class="bi bi-trash3"></i></button>
                                	</div>
                                </td>
                            </tr>
{{ end }}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
	<div id="toastnotification" class="toastnotification" data-default="API key copied to clipboard">Toast Text</div>
    </div>
</div>
<script src="./js/min/admin.min.{{ template "js_admin_version"}}.js"></script>
<script>
	var systemKey = "{{.SystemKey}}";
	var userName = "{{.ActiveUser.Name}}";
</script>

<!-- Modal for deletion confirmation -->
	<div class="modal" tabindex="-1" id="deleteModal">
	  <div class="modal-dialog gokapi-dialog">
	    <div class="modal-content gokapi-dialog">
	      <div class="modal-header">
		<h5 class="modal-title">Delete File Request</h5>
	      </div>
	      <div class="modal-body">
		<p>Are you sure you want to delete the filerequest &quot;<span id="deleteModalBodyName" class="fw-bold"></span>&quot;?<br><br>
		This also permanently deletes <span id="deleteModalBodyCount" class="fw-bold"></span> associated file(s) and cannot be undone.</p>
		</div>
	      <div class="modal-footer">
		<button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cancel</button>
		<button type="button" id="buttonDelete" class="btn btn-danger">Delete</button>
	      </div>
	    </div>
	  </div>
	</div>

        
{{ template "pagename" "ApiOverview"}}
{{ template "customjs" .}}

{{ template "footer" true }}
{{ end }}
