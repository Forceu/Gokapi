/*! streamsaver. MIT License. Jimmy WÃ¤rting <https://jimmy.warting.se/opensource> */((e,t)=>{typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()})("streamSaver",()=>{"use strict";const t=typeof window=="object"?window:this;t.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let e=null,r=!1;const l=e=>{try{e()}catch{}},c=t.WebStreamsPolyfill||{},i=t.isSecureContext;let s=/constructor/i.test(t.HTMLElement)||!!t.safari||!!t.WebKitPoint;const a=i||"MozAppearance"in document.documentElement.style?"iframe":"navigate",n={createWriteStream:h,WritableStream:t.WritableStream||c.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function o(e){if(!e)throw new Error("meh");const t=document.createElement("iframe");return t.hidden=!0,t.src=e,t.loaded=!1,t.name="iframe",t.isIframe=!0,t.postMessage=(...e)=>t.contentWindow.postMessage(...e),t.addEventListener("load",()=>{t.loaded=!0},{once:!0}),document.body.appendChild(t),t}function d(e){const i="width=200,height=100",s=document.createDocumentFragment(),n={frame:t.open(e,"popup",i),loaded:!1,isIframe:!1,isPopup:!0,remove(){n.frame.close()},addEventListener(...e){s.addEventListener(...e)},dispatchEvent(...e){s.dispatchEvent(...e)},removeEventListener(...e){s.removeEventListener(...e)},postMessage(...e){n.frame.postMessage(...e)}},o=e=>{e.source===n.frame&&(n.loaded=!0,t.removeEventListener("message",o),n.dispatchEvent(new Event("load")))};return t.addEventListener("message",o),n}try{new Response(new ReadableStream),i&&!("serviceWorker"in navigator)&&(s=!0)}catch{s=!0}l(()=>{const{readable:t}=new TransformStream,e=new MessageChannel;e.port1.postMessage(t,[t]),e.port1.close(),e.port2.close(),r=!0,Object.defineProperty(n,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})});function u(){e||(e=i?o(n.mitm):d(n.mitm))}function h(t,i,c){let d={size:null,pathname:null,writableStrategy:0[0],readableStrategy:0[0]},p=0,h=null,l=null,m=null;if(Number.isFinite(i)?([c,i]=[i,c],console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),d.size=c,d.writableStrategy=i):i&&i.highWaterMark?(console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),d.size=c,d.writableStrategy=i):d=i||{},!s){u(),l=new MessageChannel,t=encodeURIComponent(t.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const s={transferringReadable:r,pathname:d.pathname||Math.random().toString().slice(-6)+"/"+t,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+t}};d.size&&(s.headers["Content-Length"]=d.size);const i=[s,"*",[l.port2]];if(r){const t=a==="iframe"?0[0]:{transform(e,t){if(!(e instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");p+=e.length,t.enqueue(e),h&&(location.href=h,h=null)},flush(){h&&(location.href=h)}};m=new n.TransformStream(t,d.writableStrategy,d.readableStrategy);const e=m.readable;l.port1.postMessage({readableStream:e},[e])}l.port1.onmessage=t=>{t.data.download?a==="navigate"?(e.remove(),e=null,p?location.href=t.data.download:h=t.data.download):(e.isPopup&&(e.remove(),e=null,a==="iframe"&&o(n.mitm)),o(t.data.download)):t.data.abort&&(f=[],l.port1.postMessage("abort"),l.port1.onmessage=null,l.port1.close(),l.port2.close(),l=null)},e.loaded?e.postMessage(...i):e.addEventListener("load",()=>{e.postMessage(...i)},{once:!0})}let f=[];return!s&&m&&m.writable||new n.WritableStream({write(e){if(!(e instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");if(s){f.push(e);return}l.port1.postMessage(e),p+=e.length,h&&(location.href=h,h=null)},close(){if(s){const n=new Blob(f,{type:"application/octet-stream; charset=utf-8"}),e=document.createElement("a");e.href=URL.createObjectURL(n),e.download=t,e.click()}else l.port1.postMessage("end")},abort(){f=[],l.port1.postMessage("abort"),l.port1.onmessage=null,l.port1.close(),l.port2.close(),l=null}},d.writableStrategy)}return n})